# Lottery Election by Daniel Tolman
# Adapted by Howard Howardman
country_event = {
	id = ab_ottoman.13
	title = elections.800.t
	desc = elections.800.d
	picture = ELECTION_REPUBLICAN_eventPicture

	is_triggered_only = yes
	
	trigger = {
		has_reform = ottoman_corporation
		has_government_attribute = lottery_election
		NOT = {
			has_disaster = bonfire_of_the_vanities_disaster
		}
	}
	
	immediate = {
		hidden_effect = {
			define_exiled_ruler = {
				exiled_as = lottery_candidate_a_@ROOT
				dynasty = "Osmanoglu"
				min_age = 50
				max_age = 75
				change_adm = 2
				change_dip = -1
				change_mil = -1
				option = 0
			}
			define_exiled_ruler = {
				exiled_as = lottery_candidate_b_@ROOT
				dynasty = "Osmanoglu"
				min_age = 50
				max_age = 75
				change_adm = -1
				change_dip = 2
				change_mil = -1
				option = 1
			}
			define_exiled_ruler = {
				exiled_as = lottery_candidate_c_@ROOT
				dynasty = "Osmanoglu"
				min_age = 50
				max_age = 75
				change_adm = -1
				change_dip = -1
				change_mil = 2
				option = 2
			}
		}
	}

	after = {
		clear_exiled_ruler = lottery_candidate_a_@ROOT
		clear_exiled_ruler = lottery_candidate_b_@ROOT
		clear_exiled_ruler = lottery_candidate_c_@ROOT
	}

	option = {
		name = elections.800.a
		
		ai_chance = {
			factor = 0
		}
		
		set_ruler = lottery_candidate_a_@ROOT
		add_republican_tradition = -25
		
		if = {
			limit = {
				has_faction = mr_guilds
			}
			add_faction_influence = {
				faction = mr_guilds
				influence = 20
			}
		}
		custom_tooltip = lottery_candidate_bonus_one
	}

	option = {
		name = elections.800.b
		
		ai_chance = {
			factor = 0
		}
		
		set_ruler = lottery_candidate_b_@ROOT
		add_republican_tradition = -25
		if = {
			limit = {
				has_faction = mr_traders
			}
			add_faction_influence = {
				faction = mr_traders
				influence = 20
			}
		}
		custom_tooltip = lottery_candidate_bonus_one
	}

	option = {
		name = elections.800.c
		
		ai_chance = {
			factor = 0
		}
		
		set_ruler = lottery_candidate_c_@ROOT
		add_republican_tradition = -25
		if = {
			limit = {
				has_faction = mr_aristocrats
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 20
			}
		}
		custom_tooltip = lottery_candidate_bonus_one
	}

	option = {
		# lottery
		name = elections.800.da
		
		ai_chance = {
			factor = 90
		}
		
		random_list = {
			33 = {
				set_ruler = lottery_candidate_a_@ROOT
				if = {
					limit = {
						has_faction = mr_guilds
					}
					add_faction_influence = {
						faction = mr_guilds
						influence = 20
					}
				}
			}
			33 = {
				set_ruler = lottery_candidate_b_@ROOT
				if = {
					limit = {
						has_faction = mr_traders
					}
					add_faction_influence = {
						faction = mr_traders
						influence = 20
					}
				}
			}
			33 = {
				set_ruler = lottery_candidate_c_@ROOT
				if = {
					limit = {
						has_faction = mr_aristocrats
					}
					add_faction_influence = {
						faction = mr_aristocrats
						influence = 20
					}
				}
			}
		}
		custom_tooltip = lottery_candidate_bonus_plural
	}

	option = {
		# nepotism
		name = elections.800.e
		
		trigger = {
			has_government_attribute = enables_nepotism
		}
		
		ai_chance = {
			factor = 10
		}
		
		add_republican_tradition = -15
		define_ruler = {
			min_age = 30
			max_age = 50
			change_mil = -1
			change_adm = -1
			change_dip = -1
			name = "lastname"
		}
		if = {
			limit = {
				has_faction = mr_aristocrats
			}
			add_faction_influence = {
				faction = mr_aristocrats
				influence = 10
			}
		}
	}
}
